# 架构感知服务使用手册

## 安装

#### 手动安装

- 通过yum挂载repo源实现

  配置yum源：openEuler21.09 和 openEuler21.09:Epol，repo源路径：/etc/yum.repos.d/openEuler.repo。

  ```ini
  [openEuler21.09] # openEuler 21.09 官方发布源
  name=openEuler21.09
  baseurl=https://repo.openeuler.org/openEuler-21.09/everything/$basearch/ 
  enabled=1
  gpgcheck=1
  gpgkey=https://repo.openeuler.org/openEuler-21.09/everything/$basearch/RPM-GPG-KEY-openEuler
  
  [Epol] # openEuler 21.09:Epol 官方发布源
  name=Epol
  baseurl=https://repo.openeuler.org/openEuler-21.09/EPOL/main/$basearch/ 
  enabled=1
  gpgcheck=1
  gpgkey=https://repo.openeuler.org/openEuler-21.09/OS/$basearch/RPM-GPG-KEY-openEuler
  ```

  然后执行如下指令下载以及安装gala-ragdoll及其依赖。

  ```shell
  # A-Ops 架构感知，通常安装在主节点上
  yum install gala-spider 
  yum install python3-gala-spider
  
  # A-Ops 架构感知探针，通常安装在主节点上
  yum install gala-gopher 
  ```

- 通过安装rpm包实现。先下载gala-ragdoll-vx.x.x-x.oe1.aarch64.rpm，然后执行如下命令进行安装（其中x.x-x表示版本号，请用实际情况替代）。

  ```shell
  rpm -ivh gala-spider-vx.x.x-x.oe1.aarch64.rpm
  
  rpm -ivh gala-gopher-vx.x.x-x.oe1.aarch64.rpm
  ```



#### 使用Aops部署服务安装

##### 编辑任务列表

修改部署任务列表，打开gala_ragdoll步骤开关：

```yaml
---
step_list:
 ...
 gala_gopher:
   enable: false
   continue: false
 gala_spider:
   enable: false
   continue: false
 ...
```

##### 编辑主机清单

具体步骤参见[部署管理使用手册](部署管理使用手册.md)章节2.2.2.11章节gala-spider与gala-gopher模块主机配置

##### 编辑变量列表

具体步骤参见[部署管理使用手册](部署管理使用手册.md)章节2.2.2.11章节gala-spider与gala-gopher模块变量配置

##### 执行部署任务

具体步骤参见[部署管理使用手册](部署管理使用手册.md)章节3执行部署任务